\ProvidesPackage{secctex}

% Local packages
\RequirePackage{mathpartir}
\RequirePackage{unlist}

% CTAN packages
\RequirePackage{todonotes}
\RequirePackage{letltxmacro}
\RequirePackage{bookmark}
\RequirePackage{ifthen}

\RequirePackage{latexsym,amsmath,amssymb}
\RequirePackage{stmaryrd}
%% stmry doesn't have a bold defined, so define bold to be normal
\SetSymbolFont{stmry}{bold}{U}{stmry}{m}{n}

\RequirePackage{amsbsy}
\RequirePackage{upgreek}
\RequirePackage{url}
\RequirePackage{mathrsfs}

\RequirePackage{amsthm}
\RequirePackage{titlecaps}

% ACM recommended packages
\RequirePackage{microtype}
\RequirePackage[utf8]{inputenc}
\RequirePackage[T1]{fontenc}

%%% Conditional definitions

%% omitthis
\newcommand{\omitthis}[1]{#1}
\DeclareOption{omit}{
  \renewcommand{\omitthis}[1]{}
}

\makeatletter
%% todo
\LetLtxMacro{\savedtodo}{\todo}

\renewcommand{\todo}[2][]{\omitthis{\savedtodo[#1]{#2}}}

\DeclareOption{todo}{
  \renewcommand{\todo}[2][]{\savedtodo[#1]{#2}}
}

%% ACM/SIGPLAN format
\newif\ifsecc@sigplan
\secc@sigplantrue

\DeclareOption{nosigplan}{\secc@sigplanfalse}

%% balance the last page?
\newif\ifsecc@balance
\secc@balancefalse

\DeclareOption{balance}{\secc@balancetrue}

%% techrpt or paper?
\newif\ifsecc@techrpt
\secc@techrptfalse

\DeclareOption{techrpt}{\secc@techrpttrue}
\DeclareOption{paper}{\secc@techrptfalse}

\ProcessOptions\relax

\ifsecc@sigplan
  \RequirePackage{natbib}
  \bibpunct{[}{]}{,}{n}{}{,}
  \let\cite=\citep
\fi

\ifsecc@balance
  \RequirePackage{flushend}
\fi

\ifsecc@techrpt
  \RequirePackage{fullpage}
  \renewcommand{\baselinestretch}{1.0}
\else
  \ifsecc@sigplan
  \renewcommand{\bibsection}{
    \section*{\refname\@mkboth{\MakeUppercase{\refname}}{\MakeUppercase{\refname}}}
  }
  \fi
\fi
\makeatother

\input{defs}
\endinput
